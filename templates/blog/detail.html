{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}{{ post.title }} - Блог{% endblock %}

{% block content %}
<article class="py-16 bg-white dark:bg-gray-800">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- Назад к блогу -->
        <a href="{% url 'blog:list' %}" 
           class="inline-flex items-center text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 mb-8">
            <i class="fas fa-arrow-left mr-2"></i>
            Назад к блогу
        </a>
        
        <!-- Заголовок -->
        <header class="mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4">
                {{ post.title }}
            </h1>
            
            <!-- Метаинфо -->
            <div class="flex flex-wrap items-center gap-4 text-gray-600 dark:text-gray-400 mb-6">
                <div class="flex items-center">
                    <i class="fas fa-calendar-alt mr-2"></i>
                    {{ post.created_at|date:"d F Y" }}
                </div>
                <div class="flex items-center">
                    <i class="fas fa-clock mr-2"></i>
                    ~{{ post.content|wordcount|floatformat:0|add:"200"|floordiv:200 }} минут чтения
                </div>
                {% if post.updated_at != post.created_at %}
                <div class="flex items-center">
                    <i class="fas fa-edit mr-2"></i>
                    Обновлено {{ post.updated_at|date:"d.m.Y" }}
                </div>
                {% endif %}
            </div>
            
            <!-- Теги -->
            {% if post.tags %}
            <div class="flex flex-wrap gap-2">
                {% for tag in post.tags_list%}
                <span class="bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 px-3 py-1 rounded-lg">
                    #{{ tag|trim }}
                </span>
                {% endfor %}
            </div>
            {% endif %}
        </header>
        
        <!-- Содержание поста -->
        <div class="prose dark:prose-invert prose-lg max-w-none">
            <div class="text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-line">
                {{ post.content|linebreaks }}
            </div>
        </div>
        
        <!-- Разделитель -->
        <hr class="my-12 border-gray-200 dark:border-gray-700">
        
        <!-- Поделиться -->
        <div class="flex items-center justify-between">
            <div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
                    Понравилась статья?
                </h3>
                <p class="text-gray-600 dark:text-gray-400">
                    Поделитесь с друзьями!
                </p>
            </div>
            <div class="flex gap-3">
                <a href="https://twitter.com/intent/tweet?text={{ post.title|urlencode }}&url={{ request.build_absolute_uri }}" 
                   target="_blank"
                   class="bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 transition">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" 
                   target="_blank"
                   class="bg-blue-700 text-white p-3 rounded-lg hover:bg-blue-800 transition">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="https://t.me/share/url?url={{ request.build_absolute_uri }}&text={{ post.title|urlencode }}" 
                   target="_blank"
                   class="bg-blue-400 text-white p-3 rounded-lg hover:bg-blue-500 transition">
                    <i class="fab fa-telegram"></i>
                </a>
                <button onclick="copyLink()" 
                        class="bg-gray-600 text-white p-3 rounded-lg hover:bg-gray-700 transition">
                    <i class="fas fa-link"></i>
                </button>
            </div>
        </div>
        
        <!-- Навигация -->
        <div class="mt-12 border-t dark:border-gray-700 pt-8">
            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">
                Другие статьи
            </h3>
            <a href="{% url 'blog:list' %}" 
               class="inline-flex items-center text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 text-lg font-semibold">
                Посмотреть все статьи
                <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
        
    </div>
</article>

<script>
function copyLink() {
    navigator.clipboard.writeText(window.location.href).then(() => {
        alert('Ссылка скопирована в буфер обмена!');
    });
}
</script>

<style>
.prose {
    max-width: none;
}

.prose p {
    margin-bottom: 1.5rem;
}

.prose h2 {
    font-size: 1.875rem;
    font-weight: bold;
    margin-top: 2rem;
    margin-bottom: 1rem;
    color: inherit;
}

.prose h3 {
    font-size: 1.5rem;
    font-weight: bold;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    color: inherit;
}

.prose code {
    background-color: rgba(110, 110, 110, 0.1);
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
}

.prose pre {
    background-color: rgba(110, 110, 110, 0.1);
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
}
</style>
{% endblock %}